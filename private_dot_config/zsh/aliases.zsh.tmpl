alias zsh-update-plugins="find "$ZDOTDIR/plugins" -type d -exec test -e '{}/.git' ';' -print0 | xargs -I {} -0 git -C {} pull -q"
alias nvimrc='nvim ~/.config/nvim'

# Don’t use vim but nvim
alias vi="nvim"
alias vim="nvim"
alias svi="doas vi"
alias vdev='nvim --cmd "set rtp+=./" .'

# Colorize grep output (good for log files)
alias grep='grep --color=auto'
alias egrep='egrep --color=auto'
alias fgrep='fgrep --color=auto'

# Find
alias find='fn() { find "$@" -print 2> /dev/null }; fn '

ff() {
    root=$1; shift
    extension=$1; shift
    pattern="${1}"; shift
    echo -e "Looking for ${pattern} in ${root} with extension ${extension}"
    find $root -name "*.${extension}" $@ -exec grep --color="auto" -Hn ${pattern} {} \;
}

# confirm before overwriting something
alias cp="cp -i"
alias mv='mv -i'
alias ln='ln -i'
alias rm='rm -I --preserve-root'

# Don’t mess with /
alias chown='chown --preserve-root'
alias chmod='chmod --preserve-root'
alias chgrp='chgrp --preserve-root'

# easier to read disk
alias df='df -h'     # human-readable sizes
alias free='free -m' # show sizes in MB

# For when keys break
alias archlinux-fix-keys="doas pacman-key --init && doas pacman-key --populate archlinux && doas pacman-key --refresh-keys"

# Colorisze ls
## alias ls='ls --color=auto'
{{- if (eq .chezmoi.hostname "px-1021") }}
function ls () {
   if [[ "$(hostname)" == "px-1021" ]]; then
       colorls --gs --sd --dark $@
    else
        lsd -h $@
    fi
}
{{- else }}
alias ls="colorls --gs --sd --dark"
{{- end }}

# Generic useful aliases
alias mkdir='mkdir -pv'
{{- if (ne .chezmoi.hostname "visu01") }}
alias cat='bat'
alias less='cat'
alias lls='lsd -lh --total-size'
{{- end }}
alias ll='ls -l'
alias la='ls -A'
alias le='ls -l -t -r'
alias lst='ls --tree=3'
alias rms='shred -uz' # Shred (remove + overwrite) files
alias diff='colordiff'
alias ping='ping -c 5'
alias compdb='b -vn clean update |& compiledb'
if [[ "$TERM" == "xterm-kitty" ]]; then 
    alias ssh='kitty +kitten ssh'
    alias si='kitty +kitten icat'
fi
alias rsync='rsync -azv --progress'
alias scp="rsync"
alias yay='paru'
alias pacman='paru'
alias maj='paru -Syu --noconfirm && paru -Sc --noconfirm'
alias wget='wget -c' # Resurme wget by default
alias df='df -H'
alias du='du -ch'
alias top='htop'
alias cpv='rsync -ah --info=progress2'  # copy with a progress bar
alias mkcd='fn() { mkdir -pv "$1"; cd "$1" }; fn '
alias untar='tar -zxvf'
alias c='clear'
alias gdb='gdb --ex run --args'
alias weather='clear && curl wttr.in'
alias t='tail -f'

cut_wallpaper() {
    filename=$(basename -- "$1")
    extension="${filename##*.}"
    filename="${filename%.*}"
    mkdir -p ${HOME}/Images/Wallpapers
    convert -crop 1920x1080 $1 ${HOME}/Images/Wallpapers/${filename}-%d.${extension}
}

# Netcdf
nchead () {
    if [ -f $1 ]; then
        ncdump -h $1 | less
    else
        echo "'$1' does not exist."
    fi
}

# Extract archives
ex () {
    if [ -f $1 ]; then
        case $1 in
            *.tar.bz2) tar -jxf   $1;;
            *.tar.gz)  tar -zxf   $1;;
            *.bz2)     bunzip2    $1;;
            *.rar)     unrar -x   $1;;
            *.gz)      gunzip     $1;;
            *.tar)     tar -xf    $1;;
            *.tbz2)    tar -jxf   $1;;
            *.tgz)     tar -zxf   $1;;
            *.zip)     unzip      $1;;
            *.Z)       uncompress $1;;
            *.7z)      7z -x      $1;;
            *)         echo "'$1' cannot be extracted via ex()" ;;
        esac
    else
        echo "'$1' is not a valid file."
    fi
}

# Improve cd
alias cd='z'
alias cd..='z ..'
alias ..='z ../'
alias ...='z ../../..'
alias ....='z ../../../..'

# Cassandra
alias cassandra_start='doas systemctl start cassandra'
alias cassandra_status='doas systemctl status cassandra'
alias cassandra_stop='doas systemctl stop cassandra'

# Change terminal language
alias set_en='export LC_ALL=en_GB.UTF-8'
alias set_fr='export LC_ALL=fr_FR.UTF-8'

# Reboot / halt / poweroff
alias reboot='doas /sbin/reboot'
alias poweroff='doas /sbin/poweroff'
alias halt='doas /sbin/halt'
alias shutdown='doas /sbin/shutdown'

## pass options to free ##
alias meminfo='free -m -l -t'

## get top process eating memory
alias psmem='ps auxf | sort -nr -k 4'
alias psmem10='ps auxf | sort -nr -k 4 | head -10'

## get top process eating cpu ##
alias pscpu='ps auxf | sort -nr -k 3'
alias pscpu10='ps auxf | sort -nr -k 3 | head -10'

## Get server cpu info ##
alias cpuinfo='lscpu'

## older system use /proc/cpuinfo ##
##alias cpuinfo='less /proc/cpuinfo' ##
## get GPU ram on desktop / laptop##
alias gpumeminfo='grep -i --color memory /var/log/Xorg.0.log'

# Git
alias gac='git add . && git commit -a -m '

# Chezmoi
alias cme='chezmoi edit'
alias cmu='chezmoi update'
alias cmd='chezmoi diff'
alias cma='chezmoi apply'
alias cmA='chezmoi add'
alias cmAC='chezmoi add --encrypt'

# Tmux
alias t='tmux'
alias ta='t a -t'
alias tn='t new -s'
alias tls='t ls'

# Postgress
alias pg='doas -u postgres'

{{- if (or (eq .chezmoi.hostname "athena") (eq .chezmoi.hostname "gaia")) }}
alias snx_start='doas modprobe tun && doas snx'
alias regen_initramfs='doas mkinitcpio --config /etc/mkinitcpio.conf --generate /boot/initramfs-custom.img --kernel $(\ls /usr/lib/modules/)'
alias htop='btop'
{{- end }}

if [[ "$TERM" == "xterm-kitty" ]]; then 
    alias si="kitty +kitten icat"
fi

